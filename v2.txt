// ==================== å¾®ä¿¡å°ç¨‹åºå®Œæ•´é¡¹ç›®æ–‡ä»¶ ====================
// è¯·æŒ‰ç…§ä»¥ä¸‹ç»“æ„åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­åˆ›å»ºæ–‡ä»¶

// ========== /app.js ==========
App({
  globalData: {
    userInfo: null,
    token: null,
    apiUrl: 'https://your-api-domain.com/api', // ä¿®æ”¹ä¸ºæ‚¨çš„å®é™…APIåœ°å€
    role: null
  },

  onLaunch() {
    const token = wx.getStorageSync('token');
    const userInfo = wx.getStorageSync('userInfo');
    
    if (token) {
      this.globalData.token = token;
      this.globalData.userInfo = userInfo;
      this.globalData.role = userInfo.role;
    }
  },

  request(options) {
    const token = this.globalData.token;
    
    return new Promise((resolve, reject) => {
      wx.request({
        ...options,
        url: this.globalData.apiUrl + options.url,
        header: {
          'Authorization': token ? `Bearer ${token}` : '',
          'Content-Type': 'application/json',
          ...options.header
        },
        success: (res) => {
          if (res.statusCode === 200) {
            resolve(res.data);
          } else if (res.statusCode === 401) {
            wx.redirectTo({ url: '/pages/login/login' });
            reject(res);
          } else {
            wx.showToast({
              title: res.data.error || 'è¯·æ±‚å¤±è´¥',
              icon: 'none'
            });
            reject(res);
          }
        },
        fail: reject
      });
    });
  }
});

// ========== /app.json ==========
// {
//   "pages": [
//     "pages/index/index",
//     "pages/login/login",
//     "pages/course/list",
//     "pages/teacher/list",
//     "pages/teacher/detail",
//     "pages/appointment/create",
//     "pages/appointment/list",
//     "pages/my/index",
//     "pages/admin/dashboard",
//     "pages/admin/salary",
//     "pages/teacher/schedule"
//   ],
//   "window": {
//     "navigationBarTitleText": "ç´æˆ¿ç®¡ç†ç³»ç»Ÿ",
//     "navigationBarBackgroundColor": "#4A90E2",
//     "navigationBarTextStyle": "white",
//     "backgroundColor": "#f5f5f5"
//   },
//   "tabBar": {
//     "color": "#999",
//     "selectedColor": "#4A90E2",
//     "backgroundColor": "#fff",
//     "borderStyle": "black",
//     "list": [
//       {
//         "pagePath": "pages/index/index",
//         "text": "é¦–é¡µ",
//         "iconPath": "images/home.png",
//         "selectedIconPath": "images/home-active.png"
//       },
//       {
//         "pagePath": "pages/appointment/list",
//         "text": "æˆ‘çš„è¯¾ç¨‹",
//         "iconPath": "images/course.png",
//         "selectedIconPath": "images/course-active.png"
//       },
//       {
//         "pagePath": "pages/my/index",
//         "text": "æˆ‘çš„",
//         "iconPath": "images/my.png",
//         "selectedIconPath": "images/my-active.png"
//       }
//     ]
//   },
//   "sitemapLocation": "sitemap.json",
//   "lazyCodeLoading": "requiredComponents"
// }

// ========== /app.wxss ==========
/* å…¨å±€æ ·å¼ */
page {
  background-color: #f5f5f5;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
}

.container {
  padding: 20rpx;
}

/* é€šç”¨æŒ‰é’®æ ·å¼ */
.btn {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border-radius: 50rpx;
  padding: 20rpx 40rpx;
  font-size: 32rpx;
  text-align: center;
  border: none;
}

.btn-secondary {
  background: #f0f0f0;
  color: #333;
}

.btn-block {
  width: 100%;
  display: block;
}

/* å¡ç‰‡æ ·å¼ */
.card {
  background: white;
  border-radius: 20rpx;
  padding: 30rpx;
  margin-bottom: 20rpx;
  box-shadow: 0 2rpx 10rpx rgba(0,0,0,0.05);
}

/* åˆ—è¡¨æ ·å¼ */
.list-item {
  display: flex;
  align-items: center;
  padding: 30rpx 0;
  border-bottom: 1rpx solid #eee;
}

.list-item:last-child {
  border-bottom: none;
}

/* æ ‡é¢˜æ ·å¼ */
.section-title {
  font-size: 36rpx;
  font-weight: bold;
  color: #333;
  margin: 30rpx 0 20rpx;
}

// ========== /pages/login/login.js ==========
const app = getApp();

Page({
  data: {
    canIUseGetUserProfile: false
  },

  onLoad() {
    if (wx.getUserProfile) {
      this.setData({
        canIUseGetUserProfile: true
      });
    }
  },

  getUserProfile() {
    wx.getUserProfile({
      desc: 'ç”¨äºå®Œå–„ç”¨æˆ·èµ„æ–™',
      success: (res) => {
        this.wxLogin(res.userInfo);
      },
      fail: () => {
        wx.showToast({
          title: 'éœ€è¦æˆæƒæ‰èƒ½ä½¿ç”¨',
          icon: 'none'
        });
      }
    });
  },

  wxLogin(userInfo) {
    wx.showLoading({ title: 'ç™»å½•ä¸­...' });
    
    wx.login({
      success: (res) => {
        if (res.code) {
          app.request({
            url: '/auth/wxlogin',
            method: 'POST',
            data: {
              code: res.code,
              userInfo: userInfo
            }
          }).then(result => {
            wx.hideLoading();
            
            app.globalData.token = result.token;
            app.globalData.userInfo = result.user;
            app.globalData.role = result.user.role;
            
            wx.setStorageSync('token', result.token);
            wx.setStorageSync('userInfo', result.user);
            
            if (result.user.role === 'admin') {
              wx.redirectTo({ url: '/pages/admin/dashboard' });
            } else {
              wx.switchTab({ url: '/pages/index/index' });
            }
          }).catch(() => {
            wx.hideLoading();
          });
        }
      }
    });
  }
});

// ========== /pages/login/login.wxml ==========
`<view class="login-container">
  <view class="login-box">
    <view class="logo">
      <text class="logo-icon">ğŸµ</text>
    </view>
    <view class="app-name">ç´æˆ¿ç®¡ç†ç³»ç»Ÿ</view>
    <view class="app-desc">ä¸“ä¸šçš„éŸ³ä¹æ•™è‚²ç®¡ç†å¹³å°</view>
    
    <button 
      wx:if="{{canIUseGetUserProfile}}" 
      class="login-btn"
      bindtap="getUserProfile">
      <text class="btn-icon">ğŸ‘¤</text>
      å¾®ä¿¡å¿«é€Ÿç™»å½•
    </button>
    
    <button 
      wx:else 
      class="login-btn"
      open-type="getUserInfo" 
      bindgetuserinfo="getUserInfo">
      <text class="btn-icon">ğŸ‘¤</text>
      å¾®ä¿¡å¿«é€Ÿç™»å½•
    </button>
    
    <view class="tips">ç™»å½•å³è¡¨ç¤ºåŒæ„ã€Šç”¨æˆ·åè®®ã€‹å’Œã€Šéšç§æ”¿ç­–ã€‹</view>
  </view>
</view>`

// ========== /pages/login/login.wxss ==========
`.login-container {
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}

.login-box {
  width: 600rpx;
  background: rgba(255, 255, 255, 0.95);
  border-radius: 30rpx;
  padding: 60rpx;
  text-align: center;
}

.logo {
  margin-bottom: 30rpx;
}

.logo-icon {
  font-size: 100rpx;
}

.app-name {
  font-size: 48rpx;
  font-weight: bold;
  color: #333;
  margin-bottom: 20rpx;
}

.app-desc {
  font-size: 28rpx;
  color: #666;
  margin-bottom: 60rpx;
}

.login-btn {
  width: 100%;
  height: 90rpx;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border-radius: 45rpx;
  font-size: 32rpx;
  display: flex;
  align-items: center;
  justify-content: center;
  border: none;
}

.btn-icon {
  margin-right: 10rpx;
  font-size: 36rpx;
}

.tips {
  font-size: 24rpx;
  color: #999;
  margin-top: 40rpx;
}`

// ========== /pages/login/login.json ==========
// {
//   "navigationBarTitleText": "ç™»å½•",
//   "navigationStyle": "custom"
// }

// ========== /pages/index/index.js ==========
Page({
  data: {
    courseTypes: [],
    banners: [
      { id: 1, image: '/images/banner1.jpg', title: 'ä¸“ä¸šéŸ³ä¹æ•™è‚²' },
      { id: 2, image: '/images/banner2.jpg', title: 'åå¸ˆæˆè¯¾' }
    ],
    teachers: [],
    stats: {
      totalTeachers: 0,
      totalStudents: 0,
      totalCourses: 0
    }
  },

  onLoad() {
    this.checkLogin();
    this.loadCourseTypes();
    this.loadTopTeachers();
    this.loadStats();
  },

  onShow() {
    if (getApp().globalData.token) {
      this.loadCourseTypes();
    }
  },

  checkLogin() {
    if (!getApp().globalData.token) {
      wx.redirectTo({ url: '/pages/login/login' });
    }
  },

  loadCourseTypes() {
    getApp().request({
      url: '/course-types',
      method: 'GET'
    }).then(data => {
      this.setData({ 
        courseTypes: data.map(item => ({
          ...item,
          icon: this.getCourseIcon(item.name)
        }))
      });
    });
  },

  getCourseIcon(name) {
    const icons = {
      'é’¢ç´': 'ğŸ¹',
      'å‰ä»–': 'ğŸ¸',
      'å£°ä¹': 'ğŸ¤',
      'å¤ç­': 'ğŸ»',
      'å°æç´': 'ğŸ»',
      'æ¶å­é¼“': 'ğŸ¥'
    };
    return icons[name] || 'ğŸµ';
  },

  loadTopTeachers() {
    getApp().request({
      url: '/teachers',
      method: 'GET'
    }).then(data => {
      this.setData({ 
        teachers: data.slice(0, 4).map(teacher => ({
          ...teacher,
          avatar: teacher.avatar || '/images/default-avatar.png'
        }))
      });
    });
  },

  loadStats() {
    // æ¨¡æ‹Ÿç»Ÿè®¡æ•°æ®ï¼Œå®é™…åº”ä»APIè·å–
    this.setData({
      stats: {
        totalTeachers: 18,
        totalStudents: 256,
        totalCourses: 1024
      }
    });
  },

  selectCourse(e) {
    const { id, name } = e.currentTarget.dataset;
    wx.navigateTo({
      url: `/pages/teacher/list?courseId=${id}&courseName=${name}`
    });
  },

  viewTeacher(e) {
    const teacherId = e.currentTarget.dataset.id;
    wx.navigateTo({
      url: `/pages/teacher/detail?id=${teacherId}`
    });
  },

  goToAllTeachers() {
    wx.navigateTo({
      url: '/pages/teacher/list'
    });
  },

  goToAllCourses() {
    wx.navigateTo({
      url: '/pages/course/list'
    });
  }
});

// ========== /pages/index/index.wxml ==========
`<view class="index-container">
  <!-- è½®æ’­å›¾ -->
  <swiper class="banner" autoplay indicator-dots circular>
    <swiper-item wx:for="{{banners}}" wx:key="id">
      <view class="banner-item">
        <image src="{{item.image}}" mode="aspectFill" class="banner-image"></image>
        <view class="banner-title">{{item.title}}</view>
      </view>
    </swiper-item>
  </swiper>
  
  <!-- ç»Ÿè®¡æ•°æ® -->
  <view class="stats-bar">
    <view class="stat-item">
      <view class="stat-value">{{stats.totalTeachers}}</view>
      <view class="stat-label">ä¸“ä¸šæ•™å¸ˆ</view>
    </view>
    <view class="stat-item">
      <view class="stat-value">{{stats.totalStudents}}</view>
      <view class="stat-label">åœ¨è¯»å­¦ç”Ÿ</view>
    </view>
    <view class="stat-item">
      <view class="stat-value">{{stats.totalCourses}}</view>
      <view class="stat-label">ç´¯è®¡è¯¾ç¨‹</view>
    </view>
  </view>
  
  <!-- è¯¾ç¨‹ç±»å‹ -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">é€‰æ‹©è¯¾ç¨‹</text>
      <text class="section-more" bindtap="goToAllCourses">æŸ¥çœ‹å…¨éƒ¨ ></text>
    </view>
    <view class="course-grid">
      <view class="course-item" 
            wx:for="{{courseTypes}}" 
            wx:key="id"
            bindtap="selectCourse"
            data-id="{{item.id}}"
            data-name="{{item.name}}">
        <view class="course-icon">{{item.icon}}</view>
        <view class="course-name">{{item.name}}</view>
      </view>
    </view>
  </view>
  
  <!-- æ¨èæ•™å¸ˆ -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">ä¼˜ç§€æ•™å¸ˆ</text>
      <text class="section-more" bindtap="goToAllTeachers">æŸ¥çœ‹å…¨éƒ¨ ></text>
    </view>
    <view class="teacher-list">
      <view class="teacher-card" 
            wx:for="{{teachers}}" 
            wx:key="id"
            bindtap="viewTeacher"
            data-id="{{item.id}}">
        <image class="teacher-avatar" src="{{item.avatar}}"></image>
        <view class="teacher-info">
          <view class="teacher-name">{{item.name}}</view>
          <view class="teacher-meta">
            <text class="teacher-exp">{{item.experience_years}}å¹´æ•™é¾„</text>
            <text class="teacher-rating">â­ {{item.rating || 5.0}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>
</view>`

// ========== /pages/index/index.wxss ==========
`.index-container {
  padding-bottom: 20rpx;
}

.banner {
  height: 400rpx;
  margin-bottom: 20rpx;
}

.banner-item {
  position: relative;
  height: 100%;
}

.banner-image {
  width: 100%;
  height: 100%;
}

.banner-title {
  position: absolute;
  bottom: 40rpx;
  left: 40rpx;
  color: white;
  font-size: 40rpx;
  font-weight: bold;
  text-shadow: 2rpx 2rpx 10rpx rgba(0,0,0,0.5);
}

.stats-bar {
  display: flex;
  background: white;
  padding: 30rpx;
  margin: 20rpx;
  border-radius: 20rpx;
  box-shadow: 0 2rpx 10rpx rgba(0,0,0,0.05);
}

.stat-item {
  flex: 1;
  text-align: center;
}

.stat-value {
  font-size: 48rpx;
  font-weight: bold;
  color: #4A90E2;
}

.stat-label {
  font-size: 24rpx;
  color: #666;
  margin-top: 10rpx;
}

.section {
  margin: 20rpx;
  background: white;
  border-radius: 20rpx;
  padding: 30rpx;
}

.section-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 30rpx;
}

.section-more {
  font-size: 28rpx;
  color: #4A90E2;
}

.course-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 20rpx;
}

.course-item {
  text-align: center;
  padding: 20rpx;
}

.course-icon {
  font-size: 60rpx;
  margin-bottom: 10rpx;
}

.course-name {
  font-size: 26rpx;
  color: #333;
}

.teacher-list {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 20rpx;
}

.teacher-card {
  display: flex;
  padding: 20rpx;
  background: #f8f8f8;
  border-radius: 15rpx;
}

.teacher-avatar {
  width: 100rpx;
  height: 100rpx;
  border-radius: 50%;
  margin-right: 20rpx;
}

.teacher-info {
  flex: 1;
  display: flex;
  flex-direction: column;
  justify-content: center;
}

.teacher-name {
  font-size: 30rpx;
  font-weight: bold;
  color: #333;
  margin-bottom: 10rpx;
}

.teacher-meta {
  display: flex;
  align-items: center;
  font-size: 24rpx;
  color: #666;
}

.teacher-exp {
  margin-right: 20rpx;
}

.teacher-rating {
  color: #ff9500;
}`

// ========== /pages/index/index.json ==========
// {
//   "navigationBarTitleText": "é¦–é¡µ",
//   "enablePullDownRefresh": true
// }

// ========== /pages/teacher/list.js ==========
Page({
  data: {
    courseId: null,
    courseName: '',
    teachers: [],
    loading: false,
    filterOptions: ['å…¨éƒ¨', 'å¥½è¯„ä¼˜å…ˆ', 'ç»éªŒä¼˜å…ˆ', 'ä»·æ ¼ä¼˜å…ˆ'],
    filterIndex: 0
  },

  onLoad(options) {
    this.setData({
      courseId: options.courseId || null,
      courseName: options.courseName || 'å…¨éƒ¨æ•™å¸ˆ'
    });
    
    wx.setNavigationBarTitle({
      title: this.data.courseName
    });
    
    this.loadTeachers();
  },

  loadTeachers() {
    this.setData({ loading: true });
    
    const url = this.data.courseId 
      ? `/teachers?courseTypeId=${this.data.courseId}`
      : '/teachers';
    
    getApp().request({
      url: url,
      method: 'GET'
    }).then(data => {
      this.setData({ 
        teachers: data.map(teacher => ({
          ...teacher,
          avatar: teacher.avatar || '/images/default-avatar.png',
          tags: this.getTeacherTags(teacher)
        })),
        loading: false 
      });
    }).catch(() => {
      this.setData({ loading: false });
    });
  },

  getTeacherTags(teacher) {
    const tags = [];
    if (teacher.experience_years >= 5) tags.push('èµ„æ·±');
    if (teacher.rating >= 4.8) tags.push('å¥½è¯„');
    if (teacher.total_students >= 50) tags.push('äººæ°”');
    return tags;
  },

  changeFilter(e) {
    this.setData({ filterIndex: e.detail.value });
    this.sortTeachers();
  },

  sortTeachers() {
    const { filterIndex, teachers } = this.data;
    let sorted = [...teachers];
    
    switch(filterIndex) {
      case 1: // å¥½è¯„ä¼˜å…ˆ
        sorted.sort((a, b) => b.rating - a.rating);
        break;
      case 2: // ç»éªŒä¼˜å…ˆ
        sorted.sort((a, b) => b.experience_years - a.experience_years);
        break;
      case 3: // ä»·æ ¼ä¼˜å…ˆ
        sorted.sort((a, b) => (a.price || 0) - (b.price || 0));
        break;
    }
    
    this.setData({ teachers: sorted });
  },

  viewTeacherDetail(e) {
    const teacherId = e.currentTarget.dataset.id;
    wx.navigateTo({
      url: `/pages/teacher/detail?id=${teacherId}`
    });
  },

  bookCourse(e) {
    const teacher = e.currentTarget.dataset.teacher;
    
    if (!getApp().globalData.token) {
      wx.navigateTo({ url: '/pages/login/login' });
      return;
    }
    
    wx.navigateTo({
      url: `/pages/appointment/create?teacherId=${teacher.id}&courseId=${this.data.courseId}&teacherName=${teacher.name}`
    });
  }
});

// ========== /pages/teacher/list.wxml ==========
`<view class="container">
  <!-- ç­›é€‰æ  -->
  <view class="filter-bar">
    <picker bindchange="changeFilter" value="{{filterIndex}}" range="{{filterOptions}}">
      <view class="filter-picker">
        {{filterOptions[filterIndex]}} <text class="arrow">â–¼</text>
      </view>
    </picker>
  </view>
  
  <!-- æ•™å¸ˆåˆ—è¡¨ -->
  <view class="teacher-list">
    <view class="teacher-item card" wx:for="{{teachers}}" wx:key="id">
      <view class="teacher-header" bindtap="viewTeacherDetail" data-id="{{item.id}}">
        <image class="teacher-avatar" src="{{item.avatar}}"></image>
        <view class="teacher-info">
          <view class="teacher-name">
            {{item.name}}
            <text class="teacher-tag" wx:for="{{item.tags}}" wx:key="*this" wx:for-item="tag">{{tag}}</text>
          </view>
          <view class="teacher-desc">{{item.experience_years}}å¹´æ•™é¾„ | {{item.total_students || 0}}ä½å­¦ç”Ÿ</view>
          <view class="teacher-rating">
            <text class="stars">â­â­â­â­â­</text>
            <text class="score">{{item.rating || 5.0}}åˆ†</text>
          </view>
        </view>
      </view>
      
      <view class="teacher-intro">{{item.introduction || 'ä¸“ä¸šè®¤çœŸï¼Œæ•™å­¦ç»éªŒä¸°å¯Œ'}}</view>
      
      <view class="teacher-footer">
        <view class="price">
          <text class="price-label">è¯¾æ—¶è´¹</text>
          <text class="price-value">Â¥{{item.price || 200}}/å°æ—¶</text>
        </view>
        <button class="book-btn" bindtap="bookCourse" data-teacher="{{item}}">ç«‹å³é¢„çº¦</button>
      </view>
    </view>
  </view>
  
  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading">
    <text>åŠ è½½ä¸­...</text>
  </view>
  
  <!-- ç©ºçŠ¶æ€ -->
  <view wx:if="{{!loading && teachers.length === 0}}" class="empty">
    <text class="empty-icon">ğŸ“š</text>
    <text class="empty-text">æš‚æ— æ•™å¸ˆä¿¡æ¯</text>
  </view>
</view>`

// ========== /pages/teacher/list.wxss ==========
`.filter-bar {
  background: white;
  padding: 20rpx 30rpx;
  border-bottom: 1rpx solid #eee;
  position: sticky;
  top: 0;
  z-index: 100;
}

.filter-picker {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10rpx 20rpx;
  background: #f5f5f5;
  border-radius: 10rpx;
  font-size: 28rpx;
}

.arrow {
  font-size: 20rpx;
  color: #999;
}

.teacher-list {
  padding: 20rpx;
}

.teacher-item {
  margin-bottom: 20rpx;
}

.teacher-header {
  display: flex;
  margin-bottom: 20rpx;
}

.teacher-avatar {
  width: 120rpx;
  height: 120rpx;
  border-radius: 60rpx;
  margin-right: 20rpx;
}

.teacher-info {
  flex: 1;
}

.teacher-name {
  font-size: 32rpx;
  font-weight: bold;
  color: #333;
  margin-bottom: 10rpx;
}

.teacher-tag {
  display: inline-block;
  padding: 4rpx 12rpx;
  background: #4A90E2;
  color: white;
  font-size: 20rpx;
  border-radius: 20rpx;
  margin-left: 10rpx;
}

.teacher-desc {
  font-size: 26rpx;
  color: #666;
  margin-bottom: 10rpx;
}

.teacher-rating {
  display: flex;
  align-items: center;
}

.stars {
  font-size: 24rpx;
  margin-right: 10rpx;
}

.score {
  font-size: 26rpx;
  color: #ff9500;
}

.teacher-intro {
  font-size: 28rpx;
  color: #666;
  line-height: 1.5;
  margin-bottom: 20rpx;
}

.teacher-footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-top: 20rpx;
  border-top: 1rpx solid #eee;
}

.price {
  display: flex;
  flex-direction: column;
}

.price-label {
  font-size: 24rpx;
  color: #999;
}

.price-value {
  font-size: 36rpx;
  color: #ff4444;
  font-weight: bold;
}

.book-btn {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border: none;
  border-radius: 50rpx;
  padding: 15rpx 40rpx;
  font-size: 28rpx;
}

.loading, .empty {
  text-align: center;
  padding: 100rpx 0;
  color: #999;
}

.empty-icon {
  font-size: 100rpx;
  display: block;
  margin-bottom: 20rpx;
}

.empty-text {
  font-size: 28rpx;
}`

// ========== /pages/teacher/list.json ==========
// {
//   "navigationBarTitleText": "é€‰æ‹©æ•™å¸ˆ",
//   "enablePullDownRefresh": true
// }

// ========== /pages/appointment/create.js ==========
Page({
  data: {
    teacherId: null,
    courseId: null,
    teacherName: '',
    courseTypes: [],
    selectedCourse: null,
    selectedDate: '',
    selectedTime: '',
    timeSlots: [],
    notes: '',
    price: 0,
    duration: 60
  },

  onLoad(options) {
    const today = new Date();
    const dateStr = this.formatDate(today);
    
    this.setData({
      teacherId: options.teacherId,
      courseId: options.courseId,
      teacherName: options.teacherName,
      selectedDate: dateStr
    });
    
    this.loadCourseTypes();
    this.loadTeacherSchedule();
  },

  formatDate(date) {
    const year = date.getFullYear();
    const month = String(date.getMonth() + 1).padStart(2, '0');
    const day = String(date.getDate()).padStart(2, '0');
    return `${year}-${month}-${day}`;
  },

  loadCourseTypes() {
    getApp().request({
      url: '/course-types',
      method: 'GET'
    }).then(data => {
      this.setData({ courseTypes: data });
      
      if (this.data.courseId) {
        const course = data.find(c => c.id == this.data.courseId);
        this.setData({ 
          selectedCourse: course,
          price: 200 // è¿™é‡Œåº”è¯¥ä»æ•™å¸ˆä»·æ ¼è¡¨è·å–
        });
      }
    });
  },

  loadTeacherSchedule() {
    // ç”Ÿæˆæ—¶é—´æ®µ
    const slots = [];
    for (let hour = 9; hour < 21; hour++) {
      slots.push({
        value: `${hour}:00`,
        label: `${hour}:00 - ${hour + 1}:00`,
        available: this.checkTimeAvailable(hour)
      });
    }
    this.setData({ timeSlots: slots });
    
    // è·å–æ•™å¸ˆå·²é¢„çº¦æ—¶é—´
    this.loadAppointments();
  },

  checkTimeAvailable(hour) {
    // è¿™é‡Œåº”è¯¥æ£€æŸ¥å®é™…çš„é¢„çº¦æƒ…å†µ
    // æ¨¡æ‹Ÿä¸€äº›æ—¶é—´æ®µä¸å¯ç”¨
    return ![12, 13, 18].includes(hour);
  },

  loadAppointments() {
    getApp().request({
      url: `/appointments?teacherId=${this.data.teacherId}&date=${this.data.selectedDate}`,
      method: 'GET'
    }).then(data => {
      // æ›´æ–°æ—¶é—´æ®µå¯ç”¨æ€§
      const slots = this.data.timeSlots.map(slot => {
        const [hour] = slot.value.split(':');
        const isBooked = data.some(apt => {
          const [aptHour] = apt.start_time.split(':');
          return aptHour === hour && apt.status !== 'cancelled';
        });
        return {
          ...slot,
          available: !isBooked && this.checkTimeAvailable(parseInt(hour))
        };
      });
      this.setData({ timeSlots: slots });
    });
  },

  bindCourseChange(e) {
    const index = e.detail.value;
    this.setData({
      selectedCourse: this.data.courseTypes[index],
      courseId: this.data.courseTypes[index].id
    });
  },

  bindDateChange(e) {
    this.setData({ selectedDate: e.detail.value });
    this.loadTeacherSchedule();
  },

  selectTime(e) {
    const time = e.currentTarget.dataset.time;
    if (time.available) {
      this.setData({ selectedTime: time.value });
    } else {
      wx.showToast({
        title: 'è¯¥æ—¶é—´æ®µä¸å¯é€‰',
        icon: 'none'
      });
    }
  },

  bindDurationChange(e) {
    const durations = [60, 90, 120];
    this.setData({ 
      duration: durations[e.detail.value],
      price: this.data.price * (durations[e.detail.value] / 60)
    });
  },

  inputNotes(e) {
    this.setData({ notes: e.detail.value });
  },

  submitAppointment() {
    if (!this.data.selectedCourse) {
      wx.showToast({ title: 'è¯·é€‰æ‹©è¯¾ç¨‹ç±»å‹', icon: 'none' });
      return;
    }
    
    if (!this.data.selectedTime) {
      wx.showToast({ title: 'è¯·é€‰æ‹©ä¸Šè¯¾æ—¶é—´', icon: 'none' });
      return;
    }
    
    wx.showModal({
      title: 'ç¡®è®¤é¢„çº¦',
      content: `æ•™å¸ˆï¼š${this.data.teacherName}\nè¯¾ç¨‹ï¼š${this.data.selectedCourse.name}\næ—¶é—´ï¼š${this.data.selectedDate} ${this.data.selectedTime}\nè´¹ç”¨ï¼šÂ¥${this.data.price}`,
      success: (res) => {
        if (res.confirm) {
          this.doSubmit();
        }
      }
    });
  },

  doSubmit() {
    const [hour] = this.data.selectedTime.split(':');
    const endHour = parseInt(hour) + (this.data.duration / 60);
    const endTime = `${endHour}:00`;
    
    wx.showLoading({ title: 'æäº¤ä¸­...' });
    
    getApp().request({
      url: '/appointments',
      method: 'POST',
      data: {
        teacherId: this.data.teacherId,
        courseTypeId: this.data.courseId,
        appointmentDate: this.data.selectedDate,
        startTime: this.data.selectedTime,
        endTime: endTime,
        notes: this.data.notes
      }
    }).then(() => {
      wx.hideLoading();
      wx.showToast({ title: 'é¢„çº¦æˆåŠŸ', icon: 'success' });
      
      setTimeout(() => {
        wx.switchTab({ url: '/pages/appointment/list' });
      }, 1500);
    }).catch(() => {
      wx.hideLoading();
    });
  }
});

// ========== /pages/appointment/create.wxml ==========
`<view class="container">
  <view class="form-card card">
    <!-- æ•™å¸ˆä¿¡æ¯ -->
    <view class="teacher-info-bar">
      <text class="label">é¢„çº¦æ•™å¸ˆ</text>
      <text class="value">{{teacherName}}</text>
    </view>
    
    <!-- è¯¾ç¨‹é€‰æ‹© -->
    <view class="form-item">
      <text class="form-label">è¯¾ç¨‹ç±»å‹</text>
      <picker bindchange="bindCourseChange" range="{{courseTypes}}" range-key="name">
        <view class="picker">
          {{selectedCourse ? selectedCourse.name : 'è¯·é€‰æ‹©è¯¾ç¨‹'}}
          <text class="arrow">></text>
        </view>
      </picker>
    </view>
    
    <!-- æ—¥æœŸé€‰æ‹© -->
    <view class="form-item">
      <text class="form-label">ä¸Šè¯¾æ—¥æœŸ</text>
      <picker mode="date" value="{{selectedDate}}" bindchange="bindDateChange">
        <view class="picker">
          {{selectedDate}}
          <text class="arrow">></text>
        </view>
      </picker>
    </view>
    
    <!-- æ—¶é•¿é€‰æ‹© -->
    <view class="form-item">
      <text class="form-label">è¯¾ç¨‹æ—¶é•¿</text>
      <picker bindchange="bindDurationChange" range="{{['60åˆ†é’Ÿ', '90åˆ†é’Ÿ', '120åˆ†é’Ÿ']}}">
        <view class="picker">
          {{duration}}åˆ†é’Ÿ
          <text class="arrow">></text>
        </view>
      </picker>
    </view>
  </view>
  
  <!-- æ—¶é—´é€‰æ‹© -->
  <view class="time-section card">
    <text class="section-title">é€‰æ‹©æ—¶é—´</text>
    <view class="time-grid">
      <view class="time-slot {{!item.available ? 'disabled' : ''}} {{selectedTime === item.value ? 'selected' : ''}}"
            wx:for="{{timeSlots}}" 
            wx:key="value"
            bindtap="selectTime"
            data-time="{{item}}">
        {{item.label}}
      </view>
    </view>
  </view>
  
  <!-- å¤‡æ³¨ -->
  <view class="notes-section card">
    <text class="section-title">å¤‡æ³¨ä¿¡æ¯</text>
    <textarea class="notes-input" 
              placeholder="è¯·è¾“å…¥å­¦ä¹ éœ€æ±‚æˆ–å…¶ä»–å¤‡æ³¨..." 
              bindinput="inputNotes"
              value="{{notes}}"></textarea>
  </view>
  
  <!-- è´¹ç”¨ä¿¡æ¯ -->
  <view class="price-bar">
    <text class="price-label">è¯¾ç¨‹è´¹ç”¨</text>
    <text class="price-value">Â¥{{price}}</text>
  </view>
  
  <!-- æäº¤æŒ‰é’® -->
  <view class="submit-section">
    <button class="submit-btn" bindtap="submitAppointment">ç¡®è®¤é¢„çº¦</button>
  </view>
</view>`

// ========== /pages/appointment/create.wxss ==========
`.form-card {
  margin: 20rpx;
}

.teacher-info-bar {
  display: flex;
  justify-content: space-between;
  padding: 20rpx 0;
  border-bottom: 1rpx solid #eee;
}

.form-item {
  padding: 30rpx 0;
  border-bottom: 1rpx solid #eee;
}

.form-item:last-child {
  border-bottom: none;
}

.form-label {
  display: block;
  font-size: 28rpx;
  color: #666;
  margin-bottom: 20rpx;
}

.picker {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 32rpx;
  color: #333;
}

.arrow {
  color: #999;
}

.time-section {
  margin: 20rpx;
}

.time-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 20rpx;
  margin-top: 20rpx;
}

.time-slot {
  padding: 20rpx;
  text-align: center;
  background: #f5f5f5;
  border-radius: 10rpx;
  font-size: 26rpx;
  color: #333;
  transition: all 0.3s;
}

.time-slot.selected {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
}

.time-slot.disabled {
  background: #e0e0e0;
  color: #999;
}

.notes-section {
  margin: 20rpx;
}

.notes-input {
  width: 100%;
  height: 150rpx;
  padding: 20rpx;
  font-size: 28rpx;
  background: #f5f5f5;
  border-radius: 10rpx;
  margin-top: 20rpx;
}

.price-bar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 30rpx 40rpx;
  background: white;
  margin: 20rpx;
  border-radius: 20rpx;
}

.price-label {
  font-size: 30rpx;
  color: #666;
}

.price-value {
  font-size: 48rpx;
  color: #ff4444;
  font-weight: bold;
}

.submit-section {
  padding: 20rpx 40rpx 40rpx;
}

.submit-btn {
  width: 100%;
  height: 90rpx;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border-radius: 45rpx;
  font-size: 32rpx;
  border: none;
}`

// ========== /pages/appointment/create.json ==========
// {
//   "navigationBarTitleText": "é¢„çº¦è¯¾ç¨‹"
// }

// ========== /pages/appointment/list.js ==========
Page({
  data: {
    tabs: ['å¾…ç¡®è®¤', 'å·²ç¡®è®¤', 'å·²å®Œæˆ', 'å·²å–æ¶ˆ'],
    activeTab: 0,
    appointments: [],
    filteredAppointments: []
  },

  onLoad() {
    this.loadAppointments();
  },

  onShow() {
    this.loadAppointments();
  },

  loadAppointments() {
    wx.showLoading({ title: 'åŠ è½½ä¸­...' });
    
    getApp().request({
      url: '/appointments',
      method: 'GET'
    }).then(data => {
      wx.hideLoading();
      this.setData({ appointments: data });
      this.filterAppointments();
    }).catch(() => {
      wx.hideLoading();
    });
  },

  switchTab(e) {
    const index = e.currentTarget.dataset.index;
    this.setData({ activeTab: index });
    this.filterAppointments();
  },

  filterAppointments() {
    const statusMap = ['pending', 'confirmed', 'completed', 'cancelled'];
    const status = statusMap[this.data.activeTab];
    
    const filtered = this.data.appointments.filter(a => a.status === status);
    this.setData({ filteredAppointments: filtered });
  },

  cancelAppointment(e) {
    const id = e.currentTarget.dataset.id;
    
    wx.showModal({
      title: 'ç¡®è®¤å–æ¶ˆ',
      content: 'ç¡®å®šè¦å–æ¶ˆè¿™ä¸ªé¢„çº¦å—ï¼Ÿ',
      success: (res) => {
        if (res.confirm) {
          getApp().request({
            url: `/appointments/${id}/status`,
            method: 'PATCH',
            data: { status: 'cancelled' }
          }).then(() => {
            wx.showToast({ title: 'å·²å–æ¶ˆ', icon: 'success' });
            this.loadAppointments();
          });
        }
      }
    });
  },

  confirmComplete(e) {
    const id = e.currentTarget.dataset.id;
    
    wx.showModal({
      title: 'ç¡®è®¤å®Œæˆ',
      content: 'ç¡®è®¤å·²å®Œæˆè¿™èŠ‚è¯¾ç¨‹å—ï¼Ÿ',
      success: (res) => {
        if (res.confirm) {
          getApp().request({
            url: `/appointments/${id}/status`,
            method: 'PATCH',
            data: { status: 'completed' }
          }).then(() => {
            wx.showToast({ title: 'å·²å®Œæˆ', icon: 'success' });
            this.loadAppointments();
          });
        }
      }
    });
  },

  makePhoneCall(e) {
    const phone = e.currentTarget.dataset.phone;
    wx.makePhoneCall({
      phoneNumber: phone
    });
  }
});

// ========== /pages/appointment/list.wxml ==========
`<view class="container">
  <!-- æ ‡ç­¾æ  -->
  <view class="tabs">
    <view class="tab-item {{activeTab === index ? 'active' : ''}}" 
          wx:for="{{tabs}}" 
          wx:key="index"
          bindtap="switchTab"
          data-index="{{index}}">
      {{item}}
    </view>
  </view>
  
  <!-- é¢„çº¦åˆ—è¡¨ -->
  <view class="appointment-list">
    <view class="appointment-card" wx:for="{{filteredAppointments}}" wx:key="id">
      <view class="appointment-header">
        <view class="course-info">
          <text class="course-name">{{item.course_name}}</text>
          <text class="teacher-name">{{item.teacher_name}}è€å¸ˆ</text>
        </view>
        <view class="status status-{{item.status}}">
          {{item.status === 'pending' ? 'å¾…ç¡®è®¤' : ''}}
          {{item.status === 'confirmed' ? 'å·²ç¡®è®¤' : ''}}
          {{item.status === 'completed' ? 'å·²å®Œæˆ' : ''}}
          {{item.status === 'cancelled' ? 'å·²å–æ¶ˆ' : ''}}
        </view>
      </view>
      
      <view class="appointment-body">
        <view class="info-item">
          <text class="info-label">ä¸Šè¯¾æ—¶é—´</text>
          <text class="info-value">{{item.appointment_date}} {{item.start_time}}-{{item.end_time}}</text>
        </view>
        <view class="info-item">
          <text class="info-label">è¯¾ç¨‹è´¹ç”¨</text>
          <text class="info-value price">Â¥{{item.price}}</text>
        </view>
        <view class="info-item" wx:if="{{item.notes}}">
          <text class="info-label">å¤‡æ³¨</text>
          <text class="info-value">{{item.notes}}</text>
        </view>
      </view>
      
      <view class="appointment-footer" wx:if="{{item.status !== 'cancelled' && item.status !== 'completed'}}">
        <button class="action-btn" wx:if="{{item.status === 'pending'}}" 
                bindtap="cancelAppointment" data-id="{{item.id}}">
          å–æ¶ˆé¢„çº¦
        </button>
        <button class="action-btn primary" wx:if="{{item.status === 'confirmed'}}"
                bindtap="confirmComplete" data-id="{{item.id}}">
          ç¡®è®¤å®Œæˆ
        </button>
        <button class="action-btn" bindtap="makePhoneCall" data-phone="{{item.teacher_phone}}">
          è”ç³»è€å¸ˆ
        </button>
      </view>
    </view>
  </view>
  
  <!-- ç©ºçŠ¶æ€ -->
  <view wx:if="{{filteredAppointments.length === 0}}" class="empty">
    <text class="empty-icon">ğŸ“…</text>
    <text class="empty-text">æš‚æ— é¢„çº¦è®°å½•</text>
  </view>
</view>`

// ========== /pages/appointment/list.wxss ==========
`.tabs {
  display: flex;
  background: white;
  padding: 0 20rpx;
  position: sticky;
  top: 0;
  z-index: 100;
}

.tab-item {
  flex: 1;
  text-align: center;
  padding: 30rpx 0;
  font-size: 30rpx;
  color: #666;
  position: relative;
}

.tab-item.active {
  color: #4A90E2;
  font-weight: bold;
}

.tab-item.active::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 60rpx;
  height: 4rpx;
  background: #4A90E2;
  border-radius: 2rpx;
}

.appointment-list {
  padding: 20rpx;
}

.appointment-card {
  background: white;
  border-radius: 20rpx;
  padding: 30rpx;
  margin-bottom: 20rpx;
  box-shadow: 0 2rpx 10rpx rgba(0,0,0,0.05);
}

.appointment-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20rpx;
  padding-bottom: 20rpx;
  border-bottom: 1rpx solid #eee;
}

.course-info {
  display: flex;
  flex-direction: column;
}

.course-name {
  font-size: 32rpx;
  font-weight: bold;
  color: #333;
  margin-bottom: 10rpx;
}

.teacher-name {
  font-size: 28rpx;
  color: #666;
}

.status {
  padding: 8rpx 20rpx;
  border-radius: 20rpx;
  font-size: 24rpx;
}

.status-pending {
  background: #fff7e6;
  color: #ff9500;
}

.status-confirmed {
  background: #e6f7ff;
  color: #1890ff;
}

.status-completed {
  background: #f0f9ff;
  color: #52c41a;
}

.status-cancelled {
  background: #fff1f0;
  color: #ff4d4f;
}

.appointment-body {
  margin: 20rpx 0;
}

.info-item {
  display: flex;
  justify-content: space-between;
  margin-bottom: 15rpx;
}

.info-label {
  font-size: 26rpx;
  color: #999;
}

.info-value {
  font-size: 26rpx;
  color: #333;
}

.info-value.price {
  color: #ff4444;
  font-weight: bold;
}

.appointment-footer {
  display: flex;
  justify-content: flex-end;
  gap: 20rpx;
  padding-top: 20rpx;
  border-top: 1rpx solid #eee;
}

.action-btn {
  padding: 10rpx 30rpx;
  border-radius: 30rpx;
  font-size: 26rpx;
  background: #f5f5f5;
  color: #666;
  border: none;
}

.action-btn.primary {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
}

.empty {
  text-align: center;
  padding: 100rpx 0;
  color: #999;
}

.empty-icon {
  font-size: 100rpx;
  display: block;
  margin-bottom: 20rpx;
}

.empty-text {
  font-size: 28rpx;
}`

// ========== /pages/appointment/list.json ==========
// {
//   "navigationBarTitleText": "æˆ‘çš„è¯¾ç¨‹",
//   "enablePullDownRefresh": true
// }

// ========== /pages/my/index.js ==========
Page({
  data: {
    userInfo: null,
    role: '',
    stats: {
      totalCourses: 0,
      totalAmount: 0,
      totalHours: 0
    },
    menuItems: []
  },

  onLoad() {
    this.loadUserInfo();
    this.loadStats();
  },

  onShow() {
    this.loadUserInfo();
  },

  loadUserInfo() {
    const userInfo = getApp().globalData.userInfo;
    const role = getApp().globalData.role;
    
    if (!userInfo) {
      wx.redirectTo({ url: '/pages/login/login' });
      return;
    }
    
    this.setData({ 
      userInfo,
      role,
      menuItems: this.getMenuItems(role)
    });
  },

  getMenuItems(role) {
    const items = [
      { id: 'profile', icon: 'ğŸ‘¤', title: 'ä¸ªäººèµ„æ–™', url: '/pages/my/profile' },
      { id: 'history', icon: 'ğŸ“š', title: 'è¯¾ç¨‹è®°å½•', url: '/pages/my/history' }
    ];
    
    if (role === 'teacher') {
      items.push(
        { id: 'schedule', icon: 'ğŸ“…', title: 'æ—¶é—´ç®¡ç†', url: '/pages/teacher/schedule' },
        { id: 'income', icon: 'ğŸ’°', title: 'æ”¶å…¥ç»Ÿè®¡', url: '/pages/teacher/income' }
      );
    } else if (role === 'admin') {
      items.push(
        { id: 'admin', icon: 'ğŸ”§', title: 'åå°ç®¡ç†', url: '/pages/admin/dashboard' }
      );
    }
    
    items.push(
      { id: 'feedback', icon: 'ğŸ’¬', title: 'æ„è§åé¦ˆ', url: '/pages/my/feedback' },
      { id: 'about', icon: 'â„¹ï¸', title: 'å…³äºæˆ‘ä»¬', url: '/pages/my/about' },
      { id: 'settings', icon: 'âš™ï¸', title: 'è®¾ç½®', url: '/pages/my/settings' }
    );
    
    return items;
  },

  loadStats() {
    // åŠ è½½ç»Ÿè®¡æ•°æ®
    // è¿™é‡Œåº”è¯¥è°ƒç”¨APIè·å–å®é™…æ•°æ®
    this.setData({
      stats: {
        totalCourses: 24,
        totalAmount: 4800,
        totalHours: 24
      }
    });
  },

  navigateTo(e) {
    const url = e.currentTarget.dataset.url;
    if (url) {
      wx.navigateTo({ url });
    } else {
      wx.showToast({ title: 'åŠŸèƒ½å¼€å‘ä¸­', icon: 'none' });
    }
  },

  logout() {
    wx.showModal({
      title: 'ç¡®è®¤é€€å‡º',
      content: 'ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ',
      success: (res) => {
        if (res.confirm) {
          wx.clearStorageSync();
          getApp().globalData.token = null;
          getApp().globalData.userInfo = null;
          getApp().globalData.role = null;
          wx.redirectTo({ url: '/pages/login/login' });
        }
      }
    });
  }
});

// ========== /pages/my/index.wxml ==========
`<view class="my-container">
  <!-- ç”¨æˆ·ä¿¡æ¯ -->
  <view class="user-header">
    <image class="user-avatar" src="{{userInfo.avatar || '/images/default-avatar.png'}}"></image>
    <view class="user-info">
      <view class="user-name">{{userInfo.name || 'ç”¨æˆ·'}}</view>
      <view class="user-role">
        {{role === 'teacher' ? 'æ•™å¸ˆ' : role === 'admin' ? 'ç®¡ç†å‘˜' : 'å­¦ç”Ÿ'}}
      </view>
    </view>
  </view>
  
  <!-- ç»Ÿè®¡ä¿¡æ¯ -->
  <view class="stats-card" wx:if="{{role === 'student'}}">
    <view class="stat-item">
      <view class="stat-value">{{stats.totalCourses}}</view>
      <view class="stat-label">æ€»è¯¾ç¨‹</view>
    </view>
    <view class="stat-item">
      <view class="stat-value">{{stats.totalHours}}</view>
      <view class="stat-label">å­¦ä¹ æ—¶é•¿</view>
    </view>
    <view class="stat-item">
      <view class="stat-value">{{stats.totalAmount}}</view>
      <view class="stat-label">æ€»æ¶ˆè´¹</view>
    </view>
  </view>
  
  <!-- åŠŸèƒ½èœå• -->
  <view class="menu-list">
    <view class="menu-item" 
          wx:for="{{menuItems}}" 
          wx:key="id"
          bindtap="navigateTo"
          data-url="{{item.url}}">
      <view class="menu-left">
        <text class="menu-icon">{{item.icon}}</text>
        <text class="menu-title">{{item.title}}</text>
      </view>
      <text class="menu-arrow">></text>
    </view>
  </view>
  
  <!-- é€€å‡ºæŒ‰é’® -->
  <view class="logout-section">
    <button class="logout-btn" bindtap="logout">é€€å‡ºç™»å½•</button>
  </view>
</view>`

// ========== /pages/my/index.wxss ==========
`.my-container {
  min-height: 100vh;
  background: #f5f5f5;
}

.user-header {
  display: flex;
  align-items: center;
  padding: 40rpx;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}

.user-avatar {
  width: 120rpx;
  height: 120rpx;
  border-radius: 60rpx;
  border: 4rpx solid white;
  margin-right: 30rpx;
}

.user-info {
  flex: 1;
}

.user-name {
  font-size: 36rpx;
  color: white;
  font-weight: bold;
  margin-bottom: 10rpx;
}

.user-role {
  font-size: 28rpx;
  color: rgba(255,255,255,0.8);
}

.stats-card {
  display: flex;
  background: white;
  margin: 20rpx;
  padding: 30rpx;
  border-radius: 20rpx;
  box-shadow: 0 2rpx 10rpx rgba(0,0,0,0.05);
}

.stat-item {
  flex: 1;
  text-align: center;
}

.stat-value {
  font-size: 40rpx;
  font-weight: bold;
  color: #4A90E2;
  margin-bottom: 10rpx;
}

.stat-label {
  font-size: 24rpx;
  color: #999;
}

.menu-list {
  background: white;
  margin: 20rpx;
  border-radius: 20rpx;
  overflow: hidden;
}

.menu-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 30rpx;
  border-bottom: 1rpx solid #f0f0f0;
}

.menu-item:last-child {
  border-bottom: none;
}

.menu-left {
  display: flex;
  align-items: center;
}

.menu-icon {
  font-size: 36rpx;
  margin-right: 20rpx;
}

.menu-title {
  font-size: 30rpx;
  color: #333;
}

.menu-arrow {
  font-size: 28rpx;
  color: #999;
}

.logout-section {
  padding: 40rpx;
}

.logout-btn {
  width: 100%;
  height: 90rpx;
  background: white;
  color: #ff4444;
  border: 2rpx solid #ff4444;
  border-radius: 45rpx;
  font-size: 32rpx;
}`

// ========== /pages/my/index.json ==========
// {
//   "navigationBarTitleText": "æˆ‘çš„"
// }

// ========== /project.config.json ==========
// {
//   "description": "ç´æˆ¿ç®¡ç†ç³»ç»Ÿå°ç¨‹åº",
//   "packOptions": {
//     "ignore": []
//   },
//   "setting": {
//     "urlCheck": false,
//     "es6": true,
//     "enhance": true,
//     "postcss": true,
//     "preloadBackgroundData": false,
//     "minified": true,
//     "newFeature": false,
//     "coverView": true,
//     "nodeModules": false,
//     "autoAudits": false,
//     "showShadowRootInWxmlPanel": true,
//     "scopeDataCheck": false,
//     "uglifyFileName": false,
//     "checkInvalidKey": true,
//     "checkSiteMap": true,
//     "uploadWithSourceMap": true,
//     "compileHotReLoad": false,
//     "lazyloadPlaceholderEnable": false,
//     "useMultiFrameRuntime": true,
//     "useApiHook": true,
//     "useApiHostProcess": true,
//     "babelSetting": {
//       "ignore": [],
//       "disablePlugins": [],
//       "outputPath": ""
//     },
//     "enableEngineNative": false,
//     "useIsolateContext": true,
//     "userConfirmedBundleSwitch": false,
//     "packNpmManually": false,
//     "packNpmRelationList": [],
//     "minifyWXSS": true,
//     "showES6CompileOption": false
//   },
//   "compileType": "miniprogram",
//   "libVersion": "2.19.4",
//   "appid": "ä½ çš„å°ç¨‹åºAppID",
//   "projectname": "music-room",
//   "debugOptions": {
//     "hidedInDevtools": []
//   },
//   "scripts": {},
//   "staticServerOptions": {
//     "baseURL": "",
//     "servePath": ""
//   },
//   "isGameTourist": false,
//   "condition": {
//     "search": {
//       "list": []
//     },
//     "conversation": {
//       "list": []
//     },
//     "game": {
//       "list": []
//     },
//     "plugin": {
//       "list": []
//     },
//     "gamePlugin": {
//       "list": []
//     },
//     "miniprogram": {
//       "list": []
//     }
//   }
// }

// ========== /sitemap.json ==========
// {
//   "desc": "å…³äºæœ¬æ–‡ä»¶çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è€ƒæ–‡æ¡£ https://developers.weixin.qq.com/miniprogram/dev/framework/sitemap.html",
//   "rules": [{
//     "action": "allow",
//     "page": "*"
//   }]
// }